<script src="https://kit.fontawesome.com/0ae874aa62.js" crossorigin="anonymous"></script>
<HTML>

<head>
    <title>EV CHARGING POINT FINDER</title>
    <!-- font links -->
    <link rel="stylesheet" href="stylesheet.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Vina+Sans&display=swap" rel="stylesheet">
    <!-- icon links -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <script>

        function outputTable(data) {
            console.log(data);
            let tbody = document.getElementById("results");
            let features = data.features;
            for (let i = 0; i < features.length; i++) {
                let row = document.createElement('tr');
                tbody.appendChild(row);
                let attributes = features[i].attributes;
                
                // Create table cells for each attribute
                let chargepointCell = document.createElement('td');
                chargepointCell.textContent = attributes.Chargepoint;
                row.appendChild(chargepointCell);

                let modelVariantCell = document.createElement('td');
                modelVariantCell.textContent = attributes.Model_Variant;
                row.appendChild(modelVariantCell);

                let locationCell = document.createElement('td');
                locationCell.textContent = attributes.Location;
                row.appendChild(locationCell);

                let energyCell = document.createElement('td');
                energyCell.textContent = attributes.Energy__kWh_;
                row.appendChild(energyCell);
            }
        }

        function search(term) {
            let url = 'https://services2.arcgis.com/a4vR8lmmksFixzmB/arcgis/rest/services/Replicate_EV_Charge_point_data_April_2020/FeatureServer/0/query?where=1%3D1&outFields=Chargepoint,Location,Energy__kWh_,Model_Variant&outSR=4326&f=json'
            fetch(url,{ method: 'get' , headers: { Accept: "application/JSON" }})
            .then(res => res.json())
            .then(data => outputTable(data));
        }

        fetchData(); // Call the function to fetch data when the page loads
    </script>

</head>

<body>
    <div class="grid-container">
        <header class="green padded">
            EV CHARGING POINT FINDER 
                <span id="search">
                <input id="bar" type="text" placeholder="Search..">
                <i style="font-size:20px" class="fa">&#xf002;</i>
                <a href="http://127.0.0.1:5500/INDEX.html"><i id="home" class="fa-solid fa-house"></i></a>
            </span>
        </header>
        <nav>
            <div>
            <button onclick="location.href='FindNearest.html'" class="button1">Find nearest</button>
            </div>
            <button onclick="location.href='FindByType.html'" class="button1">Find by type</button>
        </nav>

        <main>
            <!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Table Output</title>
</head>
            <h2>Data Output Table</h2>
            <table id="outputTable">
                <thead>
                    <tr>
                        <th>Chargepoint</th>
                        <th>Model Variant</th>
                        <th>Location</th>
                        <th>Energy (kWh)</th>
                    </tr>
                </thead>
                <tbody id="results">
                    <!-- Table rows will be dynamically added here -->
                </tbody>
            </table>
        
        </main>
    </div>
    <script>
        let q = new URLSearchParams(location.search);
        let t = q.get('searchterm');
        search(t);
    </script>
</body>

</HTML>
